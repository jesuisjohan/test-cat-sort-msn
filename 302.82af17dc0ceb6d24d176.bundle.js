"use strict";(self.webpackChunkgame_core=self.webpackChunkgame_core||[]).push([[302],{77:function(t,e,r){r.r(e),r.d(e,{default:function(){return w}});var n=r(3),a=r(0),i=r(1),o=r.n(i),u=r(59),s=r(61),c=r(82),p=function(t){function e(e,r){var n;return(n=t.call(this,e,r)||this).name="SameContext",n.message=e||"The game attempted to perform a context switch into the current context.",n.code="SAME_CONTEXT",n.payload=r,n}return(0,a.Z)(e,t),e}((0,r(15).Z)(Error)),d=GameCore.Configs,m=d.LeadersBoard,h=d.Tournament,l=m.LeaderboardId,f=m.Limit,v=h.YourMockTournamentCount,y=function(){function t(t){this.id=void 0,this.title=void 0,this.contextId=void 0,this.payload=void 0,this.endTime=void 0,this.initialScore=void 0,this.id=t,this.title=this.id+"'s Tournament",this.contextId="000-"+this.id,this.initialScore=0,this.payload=JSON.stringify({playerId:"1213456",playerName:"Player",leaderboardId:l});var e=t>7?7:t;this.endTime=Math.round((Date.now()+864e5*e)/1e3)}var e=t.prototype;return e.getID=function(){return this.id},e.getTitle=function(){return this.title},e.getPayload=function(){return this.payload},e.getEndTime=function(){return this.endTime},e.getContextID=function(){return this.contextId},e.getInitialScore=function(){return this.initialScore},e.setCreatePayload=function(t){var e=t.initialScore,r=t.config,n=t.data;this.initialScore=e,r&&(this.title=r.tournamentTitle),n&&(this.payload=JSON.stringify(n))},t}(),g=function(t){function e(){var e,r;(r=t.call(this)||this).tournaments=void 0,r.tournamentData=void 0;var n=new y(1);return r.tournaments=[n],r.tournamentData=((e={})[1..toString()]=n,e),r.createYourMockTournaments(),r}(0,a.Z)(e,t);var r=e.prototype;return r.createAsync=function(){var t=(0,n.Z)(o().mark((function t(e){var r=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=r.tournaments.length+1,a=new y(n);a.setCreatePayload(e),r.tournaments.push(a),r.tournamentData[n]=a,t(a)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.shareAsync=function(){var t=(0,n.Z)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return t()})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.joinAsync=function(){var t=(0,n.Z)(o().mark((function t(e){var r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e in this.tournamentData){t.next=3;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 3:if(r=this.tournamentData[e],r.getContextID()!==FBInstant.context.getID()){t.next=7;break}return t.abrupt("return",Promise.reject(new p(null)));case 7:return t.prev=7,t.next=10,this.validateTournament(r);case 10:return t.next=12,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 12:return t.next=14,FBInstant.context.switchAsync(e);case 14:t.next=19;break;case 16:return t.prev=16,t.t0=t.catch(7),t.abrupt("return",Promise.reject(t.t0));case 19:return t.abrupt("return",Promise.resolve());case 20:case"end":return t.stop()}}),t,this,[[7,16]])})));return function(e){return t.apply(this,arguments)}}(),r.validateTournament=function(){var t=(0,n.Z)(o().mark((function t(e){var r,n,a,i,u,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getPayload(),n=JSON.parse(r),a=n.leaderboardId,i=[],t.prev=3,t.next=6,(0,s.H$)(a,{limit:f});case 6:i=t.sent,t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(3),t.abrupt("return",Promise.reject(t.t0));case 12:if(0!==i.length){t.next=14;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 14:if(u=window.game.player.getPlayerId(),i.find((function(t){return t.playerId===u}))){t.next=18;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 18:return c=null,t.prev=19,t.next=22,(0,s.xB)(u,a);case 22:c=t.sent,t.next=28;break;case 25:return t.prev=25,t.t1=t.catch(19),t.abrupt("return",Promise.reject(t.t1));case 28:if(c){t.next=30;break}return t.abrupt("return",this.getPromiseRejectTournamentNotFound());case 30:return t.abrupt("return",Promise.resolve());case 31:case"end":return t.stop()}}),t,this,[[3,9],[19,25]])})));return function(e){return t.apply(this,arguments)}}(),r.getPromiseRejectTournamentNotFound=function(){return Promise.reject(new c.Z(null))},r.postScoreAsync=function(){var t=(0,n.Z)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.getTournamentsAsync=function(){var t=(0,n.Z)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(this.tournaments),t.abrupt("return",e);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.createYourMockTournaments=function(){for(var t=window.game.player.getPlayer(),e=t.playerId,r=t.name,n=0;n<v;n++){var a=1+n+1,i=new y(a);i.setCreatePayload({initialScore:0,config:{tournamentTitle:r+" 's Tournament"},data:{playerId:e,playerName:r,leaderboardId:l}}),this.tournaments.push(i),this.tournamentData[a]=i}},e}(u.J),w=g}}]);